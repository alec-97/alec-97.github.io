---
title: 文章阅读笔记：【2018-SRMD】论文笔记：2018 SRMD 在超分辨网络中融入模糊核和噪声水平 - 知乎 - 名字越长越开心
tags:
  - 盲超分
  - 深度学习
password: 972274
categories:
  - 深度学习技术栈
  - 超分辨率重建
  - 盲超分
abbrlink: 1927094832
date: 2023-02-20 11:25:02
index_img: https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239548.webp
---

> 原文链接：
>
> 【2018-SRMD】论文笔记：2018 SRMD 在超分辨网络中融入模糊核和噪声水平 - 知乎 - 名字越长越开心
>
> 编辑于 2019-05-08 17:21
>
> ps：本文为依据个人日常阅读习惯，在原文的基础上记录阅读进度、记录个人想法和收获所写，关于原文一切内容的著作权全部归原作者所有。



> 总结：
>
> **零碎点记录：**
>
> （1）如果超分辨图像含有噪声的话，在超分辨重构的时候会放大我们不需要的噪声，如果先去噪再超分辨的策略很容易失去图像的高频细节，所以联合这两种功能是非常有必要的。文献[2]也将模糊核概念引入了超分辨网络，根据基于MAP原理的超分辨网路和降噪网络的原理可以很直观的显示出将超分辨网络和去噪网络融合再一起是具有理论基础的。
>
> 
>
> 
>
> **摘要：**
>
> 该文章的作者设计了一个具有维度拉伸策略的通用CNN框架，该框架可以将模糊内核和噪声级别作为网络的输入。使得网络在不同的退化过程中取得良好的效果，文章还指出双三次退化忽略了在场景的实用性。
>
> 
>
> **内容：**
>
> （1）模糊核：区别于降噪需要选用很多复杂的模糊核（如运动模糊核），SRMD超分辨网络通常是选用各向同性的有标准差和核宽度高斯核。
>
> （2）噪声：如果超分辨图像含有噪声的话，在超分辨重构的时候会放大我们不需要的噪声，如果先去噪再超分辨的策略很容易失去图像的高频细节，所以联合这两种功能是非常有必要的。文献[2]也将模糊核概念引入了超分辨网络，根据基于MAP原理的超分辨网路和降噪网络的原理可以很直观的显示出将超分辨网络和去噪网络融合再一起是具有理论基础的。
>
> （3）下采样器：双三次下采样。。。。这个没什么可说的，都用这个目前
>
> 
>
> **网络结构：**
>
> （1）维度拉伸策略（能够自适应地将降质map调整到输入图像大小）
>
> ![img](https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239545.webp)
>
> 维度拉伸策略：高斯核扩张成列向量，之后进行PCA主成分分析加入一个噪声属性最后和输入图形进行合成，过程理解起来比较简单，如上图所示。
>
> （2）网络结构
>
> 
>
> “通过维度拉伸策略得到的 Degradation Maps 和 LR 图像 concat，然后再传入到超分模型进行重建。自己的模型可以借鉴这个思想，然后再结合MDN”
>
> 作者认为相比与训练成一种具有泛化性（融合多种不同模糊核）的网络，设计成对单一一种情况（只用相同的降质核对训练集进行降质）进行重构的网络具有更好的效果。
>
> “这里的点是：之前的模型因为同等的对待多个卷积核，因此相比于使用多种降质核，只使用一种降质核效果很好。但是在引入了自注意力（通道、空间、多头自）之后，模型具有了更大的灵活性和选择性，因此使用多种降质核能够具有出色的表现。”

## [√] 文章信息

---

论文标题：【2018 SRMD】Learning a Single Convolutional Super-Resolution Network for Multiple Degradations

中文标题：学习适用于多种降质类型的单图超分辨率网络

论文链接：https://arxiv.org/abs/1712.06116

论文代码：https://github.com/cszn/SRMD

论文发表：2018 CVPR





## [√] 摘要

---

在现实中真实的下采样过程不完全遵循双三次下采样的过程，因此当现实降质过程不符合我们在训练超分辨网络的降质过程就会显著降低网络的重构表现。该文章的作者设计了一个具有维度拉伸策略的通用CNN框架，该框架可以将模糊内核和噪声级别作为网络的输入。使得网络在不同的退化过程中取得良好的效果，文章还指出双三次退化忽略了在场景的实用性。



## [√] 内容

---

单帧超分辨网络意在通过网络学习低分辨率图像和高分辨率图像之间的映射关系，传统的退化过程如下：

![image-20230220115155852](https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239546.png)

其中**k**代表模糊核，而**s**代表网络的下采样倍数，**n**代表降质过程中添加的高斯白噪声。论文指出他们主要有如下三个贡献：

模糊核：区别于降噪需要选用很多复杂的模糊核（如运动模糊核），SRMD超分辨网络通常是选用各向同性的有标准差和核宽度高斯核。当我们估计的高斯核比现实情况的高斯核平滑时，复原之后的图像就会过于平滑，反之当估计的高斯核比真正的高斯核锋利时，复原后的图像会产生很多人工高频特征，文献**[1]**指出模糊核的函数的不匹配很大程度上会影响超分辨网络的实际效果。

![image-20230220115351515](https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239547.png)

噪声：如果超分辨图像含有噪声的话，在超分辨重构的时候会放大我们不需要的噪声，如果先去噪再超分辨的策略很容易失去图像的高频细节，所以联合这两种功能是非常有必要的。文献**[2]**也将模糊核概念引入了超分辨网络，根据基于MAP原理的超分辨网路和降噪网络的原理可以很直观的显示出将超分辨网络和去噪网络融合再一起是具有理论基础的。

下采样器：双三次下采样。。。。这个没什么可说的，都用这个目前

**1.** 他们开发了一种摒弃传统的双三次插值网络的训练方法。

**2.** 提出新的维度拉伸方法解决低分辨图像，模糊核，噪声之间的维度不平衡问题。

**3.** 相比与其他的策略他们的效果好。。。。。emm.....



## [√] 网络结构的特点和训练过程

---

![img](https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239548.webp)

维度拉伸策略：高斯核扩张成列向量，之后进行PCA主成分分析加入一个噪声属性最后和输入图形进行合成，过程理解起来比较简单，如上图所示。

<img src="https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239549.webp" alt="img" style="zoom:80%;" />

网络由12由卷积层构成，特征图设置为128层。最后一层为上采样层。作者认为相比与训练成一种具有泛化性（融合多种不同模糊核）的网络，设计成对单一一种情况（只用相同的降质核对训练集进行降质）进行重构的网络具有更好的效果。

训练过程：模糊核的大小设置为15*15，当放大倍数分别为2，3，4时高斯核标准差的取值范围为[0.2,2],[0.2,3],[0.2,4]。噪声等级的范围为[0,75],网络被设计用来还原RGB通道的图片而不是YCBCR的Y通道的图片，数据集包括400张BSD图片，800张DIV2k图片和4744张来自于网络的图片。图片被分割为80*80，120*120，160*160的大小分别对应放大倍数为2，3，4。在训练过程中相应的训练集被划分为具有不同模糊参数的训练集。作者将他们的方法与几个比较主流的方法对比，效果如下：

![img](https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239550.webp)

![img](https://cdn.jsdelivr.net/gh/Alec-97/alec-s-images-cloud/img/202302201239551.webp)



## [√] 总结

---



文章中还有很多东西我没有写，包括对不同的高斯核进行训练（各向异性），因为现阶段超分辨网络的论文都是拿自己网络跑的效果最好图直观上对比其他的方法。所以这个网络的实际效果也是不好判断的。论文也是大概速读的一下然后总结一下，把自己可以借鉴的部分写一下。

[1]: N.Efrat, D.Glasner, A.Apartsin, B. Nadler, and A. Levin. Accurate blur models vs. image priors in single image super resolution. In IEEE International Conference on Computer Vision, pages 2832–2839, 2013. 1, 3

[2]: G. Riegler, S. Schulter, M. Ruther, and H. Bischof. Conditioned regression models for non-blind single image superresolution. In IEEE International Conference on Computer Vision, pages 522–530, 2015. 3, 5

## [√] 评论

---

- 妮綪
    楼主好，论文的过程是先要对已知的模糊核进行拉伸后和lr一起放入网络中吗？那模糊核已知的话，岂不是也只是对这类的模糊核图片效果好？
- 遵循
    楼主能解释一下这个维度拉升策略吗，PCA降维以后加入噪声变成t+1维向量，咋拉升成H*W的特征图的？

